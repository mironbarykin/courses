{% extends "auctions/layout.html" %}

{% block body %}
    <h2>Listing: {{ listing.title }}</h2>
    <img src="{{ listing.image }}">
    <p>{{ listing.description }}</p>

    <h3>${{ bid.amount }}</h3>
    {% if listing.status == "closed" %}
    {% if visitor.username == bid.author.username %}
    <h3>You are the WINNER!</h3>
    {% endif %}
    {% endif %}
    {% if listing.status == "active" %}
    <form action="" method="post"> 
        {% csrf_token %}
        <input type="hidden" name="action" value="bid">
        <div class="form-group">
            <input class="form-control" type="number" name="amount" placeholder="Bid">
        </div>
        <input class="btn btn-primary" type="submit" value="Place Bid">
    </form>
    {% endif %}
    <h4>Details</h4>
    <ul>
        <li>Author: {{ listing.author.username }}</li>
        <li>Category: {{ listing.category }}</li>
    </ul>
    <h3>Comments</h3>
    <ul>
        {% for comment in comments %}
        <li>{{ comment.content }} <br><i>{{ comment.author.username }}</i></li>
        {% endfor %}
    </ul>
    <form action="" method="post">
        {% csrf_token %}
        <input type="hidden" name="action" value="comment">
        <div class="form-group">
            <input class="form-control" type="text" name="content" placeholder="Comment">
        </div>
        <input class="btn btn-primary" type="submit" value="Place Comment">
    </form>

    {% if visitor.username == listing.author.username %}
        {% if listing.status == "active" %}
        <form action="" method="post">
            {% csrf_token %}
            <input type="hidden" name="action" value="close">
            <input class="btn btn-primary" type="submit" value="Close this listing">
        </form>
        {% endif %}
    {% else %}
        {% if watchlist == True %}
        <form action="" method="post">
            {% csrf_token %}
            <input type="hidden" name="action" value="watchlist_remove">
            <input class="btn btn-primary" type="submit" value="Remove from watchlist">
        </form>
        {% else %}
        <form action="" method="post">
            {% csrf_token %}
            <input type="hidden" name="action" value="watchlist_add">
            <input class="btn btn-primary" type="submit" value="Add to watchlist">
        </form>
        {% endif %}
    {% endif %}
{% endblock %}